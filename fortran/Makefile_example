# Modules needed on matter:
# module load intel/12.1.4  mkl/10.3.10.319
# Modules needed on India:
# module load gcc/default  atlas/3.9.33/gcc openmpi/default
# Modules needed on Milou:
# module load intel/13.1  intelmpi/4.1

OBJS =    matlab.o savem.o openm.o hpls.o leastsquare.o tikhonovm.o        padem.o config.o input.o lapack_wrapper.o poles.o padesetup.o average.o rw.o meshes.o asym.o main.o
#OBJS =   matlab.o savem.o openm.o        leastsquare.o tikhonovm.o mpim.o padem.o config.o input.o lapack_wrapper.o poles.o padesetup.o average.o rw.o meshes.o asym.o main.o
#PROG =  ../../../bin/pade_lapack_mpi
#PROG =  ../pade_lapack_mpi_v4
PROG =  Pade_approximants

#LIBRARIES on India:
LIBS = -L${LIBRARY_PATH}  -llapack -lf77blas -lcblas -latlas -L${ZGELSQUAD} -lzgelsquad -L${DGELSDQUAD} -ldgelsdquad  -L/usr/local/lib -lgmp -lmblas_gmp -lmlapack_gmp
#LIBRARIES on matter:
#LIBS = -L$(ZGELSQUAD)  -lzgelsquad  -Nmkl -mkl=sequential
#LIBRARIES on milou:
#LIBS = -L${LIBRARY_PATH}  -L${ZGELSQUAD} -lzgelsquad -L${DGELSDQUAD} -ldgelsdquad # -L/usr/local/lib -lgmp -lmblas_gmp -lmlapack_gmp

# Compiler on matter:
#F90 = ifort 
#F90FLAGS =  -O2
# Compiler on India:
INCLUDE = -I/usr/local/include -I/usr/local/include/mpack
CC = c++ -O2 # -g -fopenmp -fbounds-check  #  -Wall  # -Waddress   
F90 = gfortran -fopenmp  
#F90 = mpif90  
F90FLAGS =  -O2 # -g #-Wall -fbounds-check -Waliasing -fdump-core  -Wreturn-type 
#Compiler on milou:
#F90= mpiifort -lmkl_intel_lp64 -lmkl_sequential -lmkl_core

LDFLAGS = $(LIBS)

all: $(PROG)

$(PROG): $(OBJS)
	$(F90) $(LDFLAGS) -o $@ $(OBJS) $(LIBS)

clean:
	rm -f $(PROG) $(OBJS) *.mod


.SUFFIXES: $(SUFFIXES) .f90 .F90 .f .cpp

.f.o:
	$(F77) $(F77FLAGS) -c $<
.f90.o:
	$(F90) $(F90FLAGS) -c $<
.F90.o:
	$(F90) $(F90FLAGS) -c $<
.f90.mod:
	$(F90) $(F90FLAGS) -c $<
.F90.mod:
	$(F90) $(F90FLAGS) -c $<

.mod.o:
	$(F90) $(F90FLAGS) -c $<

.cpp.o:
	$(CC) $(INCLUDE) $(LIBS) -c $<

